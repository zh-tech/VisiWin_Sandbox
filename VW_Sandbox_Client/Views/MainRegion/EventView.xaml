<vw:View x:Class="HMI.EventView"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
         xmlns:vw="http://inosoft.com/visiwin7"
         mc:Ignorable="d"
         d:DesignHeight="850"
         d:DesignWidth="1024"
         DataContext="{vw:AdapterBinding Type=vw:StandardEventViewAdapter}">

    <d:View.DataContext>
        <vw:StandardEventViewAdapter />
    </d:View.DataContext>

    <Grid x:Name="LayoutRoot" Background="{DynamicResource ApplicationBackgroundBrush}">

        <vw:GroupBox Width="Auto" HorizontalContentAlignment="Stretch" HorizontalAlignment="Stretch" Height="Auto"
                     LocalizableHeaderText="@Events.EventView.Events" HeaderText="Logbuch"
                     VerticalAlignment="Stretch" Margin="10,10,10,0">

            <DockPanel LastChildFill="True" Margin="10,0,10,0">

                <DockPanel DockPanel.Dock="Top" Margin="0,10,0,0">

                    <vw:Button DockPanel.Dock="Right" Margin="5,0,5,0" Width="50"
                               Height="50" Padding="5"
                               Command="{Binding ShowFilterEventDialogCommand}">
                        <Viewbox Width="30" Height="30">
                            <Canvas Width="24" Height="24">
                                <Path Fill="{DynamicResource ForegroundBrush}"
                                      Data="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z" />
                            </Canvas>
                        </Viewbox>
                    </vw:Button>

                    <vw:TextVarIn LocalizableLabelText="@Events.EventView.SearchText"
                                  Style="{StaticResource ClearTextVarInStyle}"
                                  Text="{Binding SearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Delay=250}"
                                  Height="50"
                                  LocalizableWatermarkText="@Events.EventView.SearchTextWatermark" />

                </DockPanel>

                <Grid DockPanel.Dock="Bottom" Margin="0,15,0,0">

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <vw:TextBlock VerticalAlignment="Center" LocalizableText="@Events.EventView.LogFilePath"
                                  Margin="0,0,5,0" />

                    <TextBox Grid.Column="1" FontSize="{DynamicResource FontSize_Label}" Background="Transparent"
                             BorderThickness="0" 
                             IsReadOnly="True" Text="{Binding LogFilePath, Mode=OneWay}" Margin="0,0,20,0">

                        <TextBox.Style>
                            <Style TargetType="TextBox">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsKeyboardFocused, RelativeSource={RelativeSource Self}}" Value="false">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="TextBox">
                                                    <TextBlock Text="{TemplateBinding Text}" TextTrimming="CharacterEllipsis"/>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBox.Style>
                    </TextBox>

                    <Grid Grid.Column="2">

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <vw:TextBlock VerticalAlignment="Center" LocalizableText="@Events.EventView.CurrentEventCount"
                                      Margin="0,0,5,0" />

                        <TextBox Grid.Column="1" FontSize="{DynamicResource FontSize_Label}" Background="Transparent"
                                 BorderThickness="0"
                                 IsReadOnly="True" Text="{Binding CurrentEventsCount, Mode=OneWay}" />
                        
                        <vw:TextBlock Grid.Column="2" VerticalAlignment="Center" LocalizableText="@Events.EventView.Of"
                                      Margin="5,0,5,0" />

                        <TextBox Grid.Column="3" FontSize="{DynamicResource FontSize_Label}" Background="Transparent"
                                 BorderThickness="0"
                                 IsReadOnly="True" Text="{Binding EventsCount, Mode=OneWay}" />

                    </Grid>

                </Grid>

                <DataGrid ItemsSource="{Binding Events}" AutoGenerateColumns="False" MinRowHeight="30"
                          IsReadOnly="True"
                          GridLinesVisibility="None">

                    <DataGrid.Resources>

                        <Style TargetType="DataGridRow">
                            <Setter Property="Margin" Value="0,0,0,10" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Category}" Value="Success">
                                    <Setter Property="Background"
                                            Value="{Binding Path=DataContext.CurrentSetting.SuccessColorBrush, RelativeSource={RelativeSource AncestorType=vw:View}}" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Category}" Value="Informational">
                                    <Setter Property="Background"
                                            Value="{Binding Path=DataContext.CurrentSetting.InformationalColorBrush, RelativeSource={RelativeSource AncestorType=vw:View}}" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Category}" Value="Warning">
                                    <Setter Property="Background"
                                            Value="{Binding Path=DataContext.CurrentSetting.WarningColorBrush, RelativeSource={RelativeSource AncestorType=vw:View}}" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Category}" Value="Error">
                                    <Setter Property="Background"
                                            Value="{Binding Path=DataContext.CurrentSetting.ErrorColorBrush, RelativeSource={RelativeSource AncestorType=vw:View}}" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Category}" Value="Fatal">
                                    <Setter Property="Background"
                                            Value="{Binding Path=DataContext.CurrentSetting.FatalColorBrush, RelativeSource={RelativeSource AncestorType=vw:View}}" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>

                        <Style TargetType="DataGridCell">
                            <Setter Property="VerticalAlignment" Value="Center" />
                            <Style.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="{x:Null}" />
                                    <Setter Property="BorderBrush" Value="{x:Null}" />
                                </Trigger>
                                <DataTrigger Binding="{Binding Category}" Value="Success">
                                    <Setter Property="Foreground"
                                            Value="{Binding Path=DataContext.CurrentSetting.SuccessForegroundColorBrush, RelativeSource={RelativeSource AncestorType=vw:View}}" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Category}" Value="Informational">
                                    <Setter Property="Foreground"
                                            Value="{Binding Path=DataContext.CurrentSetting.InformationalForegroundColorBrush, RelativeSource={RelativeSource AncestorType=vw:View}}" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Category}" Value="Warning">
                                    <Setter Property="Foreground"
                                            Value="{Binding Path=DataContext.CurrentSetting.WarningForegroundColorBrush, RelativeSource={RelativeSource AncestorType=vw:View}}" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Category}" Value="Error">
                                    <Setter Property="Foreground"
                                            Value="{Binding Path=DataContext.CurrentSetting.ErrorForegroundColorBrush, RelativeSource={RelativeSource AncestorType=vw:View}}" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Category}" Value="Fatal">
                                    <Setter Property="Foreground"
                                            Value="{Binding Path=DataContext.CurrentSetting.FatalForegroundColorBrush, RelativeSource={RelativeSource AncestorType=vw:View}}" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>

                    </DataGrid.Resources>

                    <DataGrid.Columns>
                        <DataGridTextColumn
                            Header="{vw:LocalizedTextBinding LocalizableText=@Events.EventView.TimeStamp}"
                            Binding="{Binding Timestamp, StringFormat=yyyy-MM-dd HH:mm:ss.fff}"
                            Width="175" />
                        <DataGridTextColumn Header="{vw:LocalizedTextBinding LocalizableText=@Events.EventView.Thread}"
                                            Binding="{Binding ThreadId}" Width="60" />
                        <DataGridTextColumn
                            Header="{vw:LocalizedTextBinding LocalizableText=@Events.EventView.Category}"
                            Binding="{Binding Category}" Width="100" />
                        <DataGridTextColumn Header="{vw:LocalizedTextBinding LocalizableText=@Events.EventView.Source}"
                                            Binding="{Binding Source}" Width="100" />
                        <DataGridTextColumn
                            Header="{vw:LocalizedTextBinding LocalizableText=@Events.EventView.LogText}"
                            Binding="{Binding LogText}" Width="*" />
                    </DataGrid.Columns>

                </DataGrid>

            </DockPanel>

        </vw:GroupBox>

    </Grid>

</vw:View>